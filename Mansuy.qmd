---
title: "Mansuy"
author: "No√© Mansuy"
format: html
---
## 1 - Introduction

```{r}
library(here)
library(ggplot2)
library(vroom)
library(dplyr)
library(tidyr)
here::i_am("grades-eval.Rproj")
```
# Question 1

```{r}
courses <- vroom(here("courses.csv"))
```
# Question 2 
```{r}
courses_formatted_table <- courses |> 
  arrange(course) |> 
  select(
    'course name' = course,
    identifier = course_id,
    module = module,
    'number of exams' = nb_grades
  )
courses_formatted_table |> 
  knitr::kable()
```
# Question 3
```{r}
students <- vroom(
  here("students.csv"),
  col_types = cols(
    id = col_integer(),
    group = col_integer(), 
    birth_date = col_date(format = "%Y-%m-%d"), 
    sex = col_factor()
  )
)

print(paste("The birth_date column of the students data frame is of class",
            class(students$birth_date)))
print(paste("The sex column of the students data frame is of class",
            class(students$sex)))
```
# Question 4

```{r}
grades <- vroom(here("grades.csv"), 
  delim = ":", 
  na = "_", 
  col_types = cols(
    id = col_integer(),
    course_id = col_factor(),
    grade = col_double()
  )
)
```

## Student population analysis

# Question 5
```{r}
students |> 

  ggplot(aes(x = group)) + 
  
  geom_bar(fill = "steelblue") +
  
  labs(
    title = "Distribution of Students Across Groups",
    x = "Student Group ",
    y = "Number of Students"
  ) 
```

# Question 6

```{r}
students |>
  
  ggplot(aes(x = group, fill = sex)) +
  
 
  geom_bar(position = "fill") +
  
  labs(
    title = "Gender Balance by Student Group",
    x = "Student Group ",
    y = "Proportion of Students ",
    fill = "Gender"
  )
```
# Question 7


```{r}
library(lubridate)
students |>
  
  mutate(
    age_years = time_length(today() - birth_date, unit = "year")
  ) |>
  
  ggplot(aes(x = age_years)) +
  
  geom_histogram(fill = "darkgreen", color = "white") +
  
  labs(
    title = "Distribution of Student Age",
    x = "Age (Years)",
    y = "Number of Students"
  )
```






